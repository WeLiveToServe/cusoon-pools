---
import Base from "../layouts/Base.astro";
import { site } from "../data/site";
---
<Base
  title="Contact | Cusoon Pools"
  description="Contact Cusoon Pools for cleaning, repair, or seasonal pool service in Exeter and the Seacoast."
  canonical="https://cusoon-pools.com/contact/"
>
  <section class="pt-10 pb-16 bg-ink text-white">
    <div class="container grid gap-10 lg:grid-cols-[0.95fr_1.05fr] lg:items-center">
      <div class="text-center">
        <p class="text-base uppercase tracking-[0.4em] text-aqua/80 sm:text-xl">Contact Us</p>
        <h1 class="mt-6 font-display text-2xl sm:text-3xl">Tell us about your pool.</h1>
        <p class="mt-4 text-white/70">
          customer service is our number one priority. We fill follow up with you shortly thereafter, you can also
          just email for general questions about taking care of your own pool. We love talking to people!
        </p>
        <div class="mt-6 space-y-2 text-sm">
          <p>
            <span class="text-white/60">Phone:</span> {site.phone}
          </p>
          <p>
            <span class="text-white/60">Email:</span> {site.email}
          </p>
          <p>
            <span class="text-white/60">Hours:</span> {site.hours}
          </p>
        </div>
      </div>
      <form class="rounded-3xl bg-white/10 p-6 backdrop-blur" data-quote-form>
        <div class="grid gap-4 sm:grid-cols-2">
          <label class="text-sm">
            Name
            <input
              type="text"
              name="name"
              required
              autocomplete="name"
              placeholder="Your name"
              class="mt-2 w-full rounded-xl border border-white/20 bg-white/5 px-4 py-3 text-white placeholder:text-white/50"
            />
          </label>
          <label class="text-sm">
            Email
            <input
              type="email"
              name="email"
              required
              autocomplete="email"
              placeholder="you@email.com"
              class="mt-2 w-full rounded-xl border border-white/20 bg-white/5 px-4 py-3 text-white placeholder:text-white/50"
            />
          </label>
        </div>
        <label class="mt-4 block text-sm">
          Phone
          <input
            type="tel"
            name="phone"
            required
            autocomplete="tel"
            placeholder="(603) 555-0000"
            class="mt-2 w-full rounded-xl border border-white/20 bg-white/5 px-4 py-3 text-white placeholder:text-white/50"
          />
        </label>
        <div class="mt-6 grid gap-4 sm:grid-cols-2">
          <fieldset class="rounded-2xl border border-white/20 bg-white/5 p-4">
            <legend class="px-1 text-sm font-semibold">Type of quote request (optional)</legend>
            <div class="mt-3 space-y-2 text-sm text-white/90">
              <label class="flex items-center gap-2">
                <input type="radio" name="quoteType" value="opening/closing" class="h-4 w-4 accent-aqua" />
                <span>opening/closing</span>
              </label>
              <label class="flex items-center gap-2">
                <input type="radio" name="quoteType" value="regular cleaning service" class="h-4 w-4 accent-aqua" />
                <span>regular cleaning service</span>
              </label>
              <label class="flex items-center gap-2">
                <input type="radio" name="quoteType" value="equipment repairs and maintenance" class="h-4 w-4 accent-aqua" />
                <span>equipment repairs and maintenance</span>
              </label>
              <label class="flex items-center gap-2">
                <input
                  type="radio"
                  name="quoteType"
                  value="structural repair (tile, deck, cover anchors, etc...)"
                  class="h-4 w-4 accent-aqua"
                />
                <span>structural repair (tile, deck, cover anchors, etc...)</span>
              </label>
            </div>
          </fieldset>
          <fieldset class="rounded-2xl border border-white/20 bg-white/5 p-4">
            <legend class="px-1 text-sm font-semibold">How should we get in touch? (optional)</legend>
            <div class="mt-3 space-y-2 text-sm text-white/90">
              <label class="flex items-center gap-2">
                <input type="radio" name="contactMethod" value="call me" class="h-4 w-4 accent-aqua" />
                <span>call me</span>
              </label>
              <label class="flex items-center gap-2">
                <input type="radio" name="contactMethod" value="email me" class="h-4 w-4 accent-aqua" />
                <span>email me</span>
              </label>
              <label class="flex items-center gap-2">
                <input type="radio" name="contactMethod" value="text me" class="h-4 w-4 accent-aqua" />
                <span>text me</span>
              </label>
            </div>
          </fieldset>
        </div>
        <button
          type="submit"
          data-quote-submit
          class="mt-6 w-full rounded-full bg-sun px-6 py-3 text-sm font-semibold uppercase tracking-[0.2em] text-ink transition hover:bg-aqua"
        >
          Free Quote
        </button>
        <p class="mt-3 hidden text-xs text-white/80" data-quote-status></p>
      </form>
    </div>
  </section>
</Base>

<script is:inline>
  const quoteForm = document.querySelector("[data-quote-form]");
  const quoteStatus = document.querySelector("[data-quote-status]");
  const quoteSubmit = document.querySelector("[data-quote-submit]");

  if (quoteForm instanceof HTMLFormElement) {
    quoteForm.addEventListener("submit", async (event) => {
      event.preventDefault();
      if (!quoteForm.reportValidity()) return;

      if (quoteSubmit instanceof HTMLButtonElement) {
        quoteSubmit.disabled = true;
      }

      try {
        const response = await fetch("/api/quote", {
          method: "POST",
          body: new FormData(quoteForm),
        });

        if (!response.ok) {
          throw new Error("Quote request failed");
        }

        quoteForm.reset();
        if (quoteStatus instanceof HTMLElement) {
          quoteStatus.textContent = "lorum ipson";
          quoteStatus.classList.remove("hidden");
        }
      } catch (_error) {
        if (quoteStatus instanceof HTMLElement) {
          quoteStatus.textContent = "Unable to submit right now. Please call or email us.";
          quoteStatus.classList.remove("hidden");
        }
      } finally {
        if (quoteSubmit instanceof HTMLButtonElement) {
          quoteSubmit.disabled = false;
        }
      }
    });
  }
</script>
